{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///Users/jake/Documents/Demos/vercel-ai-sdk/lib/openai.ts"],"sourcesContent":["import { openai } from \"@ai-sdk/openai\";\nexport { openai };\n\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///Users/jake/Documents/Demos/vercel-ai-sdk/lib/sub-agent-research.ts"],"sourcesContent":["import {\n  generateText,\n  streamText,\n  generateObject,\n  streamObject,\n  wrapLanguageModel,\n} from \"ai\";\nimport { openai } from \"@/lib/openai\";\nimport { traceable } from \"langsmith/traceable\";\nimport { wrapAISDK } from \"langsmith/experimental/vercel\";\nimport { Client } from \"langsmith\";\n\n// LangSmith client for tracing\nconst langsmithClient = new Client();\nconst researchReplicas = [{ projectName: \"vercel-researcher\" }];\n\n// Wrap AI SDK for automatic tracing\nconst wrappedAISDK = wrapAISDK(\n  {\n    wrapLanguageModel,\n    generateText,\n    streamText,\n    streamObject,\n    generateObject,\n  },\n  {\n    project_name: \"vercel-ai-agent-demo\",\n    replicas: researchReplicas,\n  }\n);\n\n/**\n * Sub-agent that specializes in research and analysis tasks\n * This agent is called as a tool from the main agent\n * Traces are sent to both the main project and the 'vercel-researcher' project via replicas\n */\nexport const researchAgent = traceable(\n  async (query: string): Promise<string> => {\n    const result = await wrappedAISDK.generateText({\n      model: openai(\"gpt-4o-mini\"),\n      system: `You are a focused researchanalyst.\n- Provide structured findings with short sections: Key Insights, Supporting Evidence, References (real sources only if provided, otherwise describe the type of source).\n- Highlight concrete facts, numbers, and tradeoffs relevant to the query.\n- If the answer would be speculative, say what additional information is required.`,\n      prompt: query,\n    });\n\n    return result.text;\n  },\n  {\n    name: \"research_agent\",\n    run_type: \"llm\",\n    client: langsmithClient,\n    replicas: researchReplicas\n  }\n);\n"],"names":[],"mappings":";;;;AAAA;AAOA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;AAEA,+BAA+B;AAC/B,MAAM,kBAAkB,IAAI,sJAAM;AAClC,MAAM,mBAAmB;IAAC;QAAE,aAAa;IAAoB;CAAE;AAE/D,oCAAoC;AACpC,MAAM,eAAe,IAAA,mLAAS,EAC5B;IACE,mBAAA,2KAAiB;IACjB,cAAA,sKAAY;IACZ,YAAA,oKAAU;IACV,cAAA,sKAAY;IACZ,gBAAA,wKAAc;AAChB,GACA;IACE,cAAc;IACd,UAAU;AACZ;AAQK,MAAM,gBAAgB,IAAA,6JAAS,EACpC,OAAO;IACL,MAAM,SAAS,MAAM,aAAa,YAAY,CAAC;QAC7C,OAAO,IAAA,mKAAM,EAAC;QACd,QAAQ,CAAC;;;kFAGmE,CAAC;QAC7E,QAAQ;IACV;IAEA,OAAO,OAAO,IAAI;AACpB,GACA;IACE,MAAM;IACN,UAAU;IACV,QAAQ;IACR,UAAU;AACZ"}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/fake_sales_data.json"],"sourcesContent":["[{\"company_name\":\"Apple\",\"description\":\"Exploring an enterprise licensing agreement for Apple Intelligence services across the retail team.\",\"deal_stage\":\"prospecting\"},{\"company_name\":\"Microsoft\",\"description\":\"Evaluating joint go-to-market motion for Azure OpenAI integrations in productivity SKUs.\",\"deal_stage\":\"qualified\"},{\"company_name\":\"Netflix\",\"description\":\"Proposal for audience analytics copilots supporting content programming decisions.\",\"deal_stage\":\"proposal\"},{\"company_name\":\"Tesla\",\"description\":\"Negotiating multi-year contract to embed AI support tools in service centers worldwide.\",\"deal_stage\":\"negotiation\"},{\"company_name\":\"Amazon\",\"description\":\"Pilot closed for integrating AI-assisted merchandising insights into Amazon Fashion.\",\"deal_stage\":\"closed\"}]"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 109, "column": 809}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file:///Users/jake/Documents/Demos/vercel-ai-sdk/lib/sub-agent-sales.ts"],"sourcesContent":["import {\n  generateText,\n  streamText,\n  generateObject,\n  streamObject,\n  wrapLanguageModel,\n} from \"ai\";\nimport { openai } from \"@/lib/openai\";\nimport { traceable } from \"langsmith/traceable\";\nimport { Client } from \"langsmith\";\nimport { wrapAISDK } from \"langsmith/experimental/vercel\";\nimport { z } from \"zod\";\nimport salesData from \"./fake_sales_data.json\";\n\ntype DealStage =\n  | \"prospecting\"\n  | \"qualified\"\n  | \"proposal\"\n  | \"negotiation\"\n  | \"closed\";\n\ninterface SalesRecord {\n  company_name: string;\n  description: string;\n  deal_stage: DealStage;\n}\n\ninterface SalesAgentInput {\n  company?: string;\n}\n\nconst langsmithClient = new Client();\nconst salesReplicas = [{ projectName: \"vercel-sales-agent\" }];\nconst normalizedSalesData = salesData as SalesRecord[];\n\nconst SALES_AGENT_SYSTEM_PROMPT = `\nYou are Sales Assistant, a revenue strategist.\n- You have a lookupSalesData tool that returns JSON rows for deals.\n- Always call the tool before answering so you work from real data.\n- After the tool returns results, you MUST synthesize and provide a written response analyzing the data.\n- Respond with expert insights about the company and the deals based on the tool results.\n- If no data matches, explain which filters were used and suggest a follow-up action.\n- IMPORTANT: After calling the tool, always provide a written summary and analysis - never stop after just calling the tool.\n`;\n\nconst filterRecords = ({ company }: SalesAgentInput): SalesRecord[] => {\n  const normalizedCompany = company?.trim().toLowerCase();\n\n  let filtered = normalizedSalesData;\n  if (normalizedCompany) {\n    filtered = filtered.filter((record) =>\n      record.company_name.toLowerCase().includes(normalizedCompany)\n    );\n  }\n  return filtered;\n};\n\nconst lookupSalesDataTool = {\n  description:\n    \"Look up deals in the fake_sales_data.json file. Returns the matching records.\",\n  inputSchema: z.object({\n    company: z\n      .string()\n      .describe(\"Company name to filter on\")\n      .optional(),\n  }),\n  execute: async ({ company }: SalesAgentInput = {}) => {\n    const records = filterRecords({ company });\n    return {\n      count: records.length,\n      records,\n      stages: Array.from(new Set(records.map((record) => record.deal_stage))),\n    };\n  },\n};\n\nconst salesTools = {\n  lookupSalesData: lookupSalesDataTool,\n};\n\nconst wrappedAISDK = wrapAISDK(\n  {\n    wrapLanguageModel,\n    generateText,\n    streamText,\n    streamObject,\n    generateObject,\n  },\n  {\n    project_name: \"vercel-ai-agent-demo\",\n    replicas: salesReplicas,\n  }\n);\n\nconst buildPromptFromFilters = ({ company }: SalesAgentInput) => {\n  const parts = [\"Create a sales pipeline summary using the data tool.\"];\n  if (company) {\n    parts.push(`Company focus: ${company}.`);\n  } else {\n    parts.push(\"Company focus: not specified.\");\n  }\n  parts.push(\n    \"Use the lookupSalesData tool once with the requested filters, then craft your answer.\"\n  );\n  return parts.join(\"\\n\");\n};\n\nexport const salesAgent = traceable(\n  async ({ company }: SalesAgentInput = {}) => {\n    const result = await wrappedAISDK.generateText({\n      model: openai(\"gpt-4o-mini\"),\n      system: SALES_AGENT_SYSTEM_PROMPT,\n      prompt: buildPromptFromFilters({ company }),\n      tools: salesTools,\n    });\n\n    return result.text;\n  },\n  {\n    name: \"sales_agent\",\n    run_type: \"tool\",\n    client: langsmithClient,\n    project_name: \"vercel-ai-agent-demo\",\n    replicas: salesReplicas,\n  }\n);\n"],"names":[],"mappings":";;;;AAAA;AAOA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;;;;;;;;AAmBA,MAAM,kBAAkB,IAAI,sJAAM;AAClC,MAAM,gBAAgB;IAAC;QAAE,aAAa;IAAqB;CAAE;AAC7D,MAAM,sBAAsB,yGAAS;AAErC,MAAM,4BAA4B,CAAC;;;;;;;;AAQnC,CAAC;AAED,MAAM,gBAAgB,CAAC,EAAE,OAAO,EAAmB;IACjD,MAAM,oBAAoB,SAAS,OAAO;IAE1C,IAAI,WAAW;IACf,IAAI,mBAAmB;QACrB,WAAW,SAAS,MAAM,CAAC,CAAC,SAC1B,OAAO,YAAY,CAAC,WAAW,GAAG,QAAQ,CAAC;IAE/C;IACA,OAAO;AACT;AAEA,MAAM,sBAAsB;IAC1B,aACE;IACF,aAAa,oLAAC,CAAC,MAAM,CAAC;QACpB,SAAS,oLAAC,CACP,MAAM,GACN,QAAQ,CAAC,6BACT,QAAQ;IACb;IACA,SAAS,OAAO,EAAE,OAAO,EAAmB,GAAG,CAAC,CAAC;QAC/C,MAAM,UAAU,cAAc;YAAE;QAAQ;QACxC,OAAO;YACL,OAAO,QAAQ,MAAM;YACrB;YACA,QAAQ,MAAM,IAAI,CAAC,IAAI,IAAI,QAAQ,GAAG,CAAC,CAAC,SAAW,OAAO,UAAU;QACtE;IACF;AACF;AAEA,MAAM,aAAa;IACjB,iBAAiB;AACnB;AAEA,MAAM,eAAe,IAAA,mLAAS,EAC5B;IACE,mBAAA,2KAAiB;IACjB,cAAA,sKAAY;IACZ,YAAA,oKAAU;IACV,cAAA,sKAAY;IACZ,gBAAA,wKAAc;AAChB,GACA;IACE,cAAc;IACd,UAAU;AACZ;AAGF,MAAM,yBAAyB,CAAC,EAAE,OAAO,EAAmB;IAC1D,MAAM,QAAQ;QAAC;KAAuD;IACtE,IAAI,SAAS;QACX,MAAM,IAAI,CAAC,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC;IACzC,OAAO;QACL,MAAM,IAAI,CAAC;IACb;IACA,MAAM,IAAI,CACR;IAEF,OAAO,MAAM,IAAI,CAAC;AACpB;AAEO,MAAM,aAAa,IAAA,6JAAS,EACjC,OAAO,EAAE,OAAO,EAAmB,GAAG,CAAC,CAAC;IACtC,MAAM,SAAS,MAAM,aAAa,YAAY,CAAC;QAC7C,OAAO,IAAA,mKAAM,EAAC;QACd,QAAQ;QACR,QAAQ,uBAAuB;YAAE;QAAQ;QACzC,OAAO;IACT;IAEA,OAAO,OAAO,IAAI;AACpB,GACA;IACE,MAAM;IACN,UAAU;IACV,QAAQ;IACR,cAAc;IACd,UAAU;AACZ"}},
    {"offset": {"line": 221, "column": 0}, "map": {"version":3,"sources":["file:///Users/jake/Documents/Demos/vercel-ai-sdk/lib/tools.ts"],"sourcesContent":["import { z } from \"zod\";\nimport { researchAgent } from \"./sub-agent-research\";\nimport { salesAgent } from \"./sub-agent-sales\";\nimport { withRunTree } from \"langsmith/traceable\";\n\ntype RunTreeContext = Parameters<typeof withRunTree>[0];\n\nconst runAsIsolatedTrace = async <T>(fn: () => Promise<T>) => {\n  // Passing `undefined` drops the parent ALS context so the wrapped traceable function\n  // creates a new root run (allowing us to use custom replicas for this tool only).\n  return withRunTree(undefined as unknown as RunTreeContext, fn);\n};\n\nconst researchQuerySchema = z.object({\n  query: z.string().describe(\"The research question or topic to investigate\"),\n});\n\nconst salesQuerySchema = z.object({\n  company: z\n    .string()\n    .describe(\"Optional company name to filter on; leave empty for full summary\")\n    .optional(),\n});\n\nexport const tools = {\n  askResearchAgent: {\n    description: \"Delegate complex research or analysis questions to a specialized research agent. Use this when you need detailed information or in-depth analysis.\",\n    inputSchema: researchQuerySchema,\n    execute: async ({ query }: { query: string }) => {\n      const answer = await runAsIsolatedTrace(() => researchAgent(query));\n      return { answer };\n    },\n  },\n  querySalesAgent: {\n    description: \"Look up deals in the sales database. Use to gather pipeline info about public companies.\",\n    inputSchema: salesQuerySchema,\n    execute: async ({\n      company,\n    }: {\n      company?: string;\n    }) => {\n      const summary = await runAsIsolatedTrace(() =>\n        salesAgent({ company })\n      );\n      return { summary };\n    },\n  },\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AAAA;;;;;AAIA,MAAM,qBAAqB,OAAU;IACnC,qFAAqF;IACrF,kFAAkF;IAClF,OAAO,IAAA,+JAAW,EAAC,WAAwC;AAC7D;AAEA,MAAM,sBAAsB,oLAAC,CAAC,MAAM,CAAC;IACnC,OAAO,oLAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AAC7B;AAEA,MAAM,mBAAmB,oLAAC,CAAC,MAAM,CAAC;IAChC,SAAS,oLAAC,CACP,MAAM,GACN,QAAQ,CAAC,oEACT,QAAQ;AACb;AAEO,MAAM,QAAQ;IACnB,kBAAkB;QAChB,aAAa;QACb,aAAa;QACb,SAAS,OAAO,EAAE,KAAK,EAAqB;YAC1C,MAAM,SAAS,MAAM,mBAAmB,IAAM,IAAA,kJAAa,EAAC;YAC5D,OAAO;gBAAE;YAAO;QAClB;IACF;IACA,iBAAiB;QACf,aAAa;QACb,aAAa;QACb,SAAS,OAAO,EACd,OAAO,EAGR;YACC,MAAM,UAAU,MAAM,mBAAmB,IACvC,IAAA,4IAAU,EAAC;oBAAE;gBAAQ;YAEvB,OAAO;gBAAE;YAAQ;QACnB;IACF;AACF"}},
    {"offset": {"line": 273, "column": 0}, "map": {"version":3,"sources":["file:///Users/jake/Documents/Demos/vercel-ai-sdk/app/api/agent/route.ts"],"sourcesContent":["import {\n  generateText,\n  streamText,\n  generateObject,\n  streamObject,\n  wrapLanguageModel,\n} from \"ai\";\nimport { openai } from \"@/lib/openai\";\nimport { tools } from \"@/lib/tools\";\nimport { traceable } from \"langsmith/traceable\";\nimport { wrapAISDK } from \"langsmith/experimental/vercel\";\nimport { Client } from \"langsmith\";\n\n// Using Node.js runtime for LangSmith Client compatibility\nexport const runtime = \"nodejs\";\n\nconst langsmithClient = new Client();\nconst MAIN_AGENT_SYSTEM_PROMPT = `\n    You are the primary orchestrator for a research + sales assistant.\n    - Read the conversation carefully.\n    - Decide whether to call tools: use querySalesAgent for pipeline data, and askResearchAgent for open-ended analysis.\n    - Combine tool outputs into a concise answer with sections:\n      1. Summary\n      2. Tool Findings (list each tool and its key data)\n      3. Next Steps (only if useful)\n    - If you need more info, explain what tool call you plan to make.\n`;\n\n// Wrap AI SDK for automatic tracing\nconst wrappedAISDK = wrapAISDK(\n  {\n    wrapLanguageModel,\n    generateText,\n    streamText,\n    streamObject,\n    generateObject,\n  },\n  {\n    project_name: \"vercel-ai-agent-demo\",\n  }\n);\n\nconst handleAgentRequest = traceable(\n  async (messages: any[]) => {\n    const conversation = [\n      { role: \"system\", content: MAIN_AGENT_SYSTEM_PROMPT },\n      ...(messages ?? []),\n    ];\n\n    const result = await wrappedAISDK.generateText({\n      model: openai(\"gpt-4o\"),\n      messages: conversation,\n      tools,\n    });\n\n    return {\n      text: result.text,\n      toolCalls: result.toolCalls,\n      toolResults: result.toolResults,\n      finishReason: result.finishReason,\n    };\n  },\n  {\n    name: \"main_agent\",\n    run_type: \"chain\",\n    client: langsmithClient,\n  }\n);\n\nexport async function POST(req: Request) {\n  const { messages } = await req.json();\n  const result = await handleAgentRequest(messages);\n\n  // Ensure traces are flushed before response\n  await langsmithClient.awaitPendingTraceBatches();\n\n  return Response.json(result);\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAOA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;;AAGO,MAAM,UAAU;AAEvB,MAAM,kBAAkB,IAAI,sJAAM;AAClC,MAAM,2BAA2B,CAAC;;;;;;;;;AASlC,CAAC;AAED,oCAAoC;AACpC,MAAM,eAAe,IAAA,mLAAS,EAC5B;IACE,mBAAA,2KAAiB;IACjB,cAAA,sKAAY;IACZ,YAAA,oKAAU;IACV,cAAA,sKAAY;IACZ,gBAAA,wKAAc;AAChB,GACA;IACE,cAAc;AAChB;AAGF,MAAM,qBAAqB,IAAA,6JAAS,EAClC,OAAO;IACL,MAAM,eAAe;QACnB;YAAE,MAAM;YAAU,SAAS;QAAyB;WAChD,YAAY,EAAE;KACnB;IAED,MAAM,SAAS,MAAM,aAAa,YAAY,CAAC;QAC7C,OAAO,IAAA,mKAAM,EAAC;QACd,UAAU;QACV,OAAA,uHAAK;IACP;IAEA,OAAO;QACL,MAAM,OAAO,IAAI;QACjB,WAAW,OAAO,SAAS;QAC3B,aAAa,OAAO,WAAW;QAC/B,cAAc,OAAO,YAAY;IACnC;AACF,GACA;IACE,MAAM;IACN,UAAU;IACV,QAAQ;AACV;AAGK,eAAe,KAAK,GAAY;IACrC,MAAM,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;IACnC,MAAM,SAAS,MAAM,mBAAmB;IAExC,4CAA4C;IAC5C,MAAM,gBAAgB,wBAAwB;IAE9C,OAAO,SAAS,IAAI,CAAC;AACvB"}}]
}